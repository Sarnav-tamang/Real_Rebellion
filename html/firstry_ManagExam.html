<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Make Exams</title>
    <link rel="stylesheet" href="/rebellion/css/firstry.css" />
    <link rel="stylesheet" href="/rebellion/css/firstryMangExam.css" />
    <style>
      div[class="Check_Sheet"] {
        max-width: 10em;
        min-width: 9em;

        background-color: rgb(29, 114, 114);
        text-align: center;
        border-radius: 8px;
        border: 3px solid;
        transition: 100ms ease-in-out;
        margin-top: 3em;
        padding: 9px;
      }
      div[class="Check_Sheet"]:hover,
      div[class="Check_Sheet"]:focus {
        border-radius: 15px;
        background-color: rgb(3, 82, 82);
      }
    </style>
  </head>

  <body>
    <nav id="sidebar">
      <ul>
        <li>
          <span class="logo">ðŸ“Š Menu</span>
          <button onclick="toggleSidebar()" id="toggle-btn">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="m313-480 155 156q11 11 11.5 27.5T468-268q-11 11-28 11t-28-11L228-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T468-692q11 11 11 28t-11 28L313-480Zm264 0 155 156q11 11 11.5 27.5T732-268q-11 11-28 11t-28-11L492-452q-6-6-8.5-13t-2.5-15q0-8 2.5-15t8.5-13l184-184q11-11 27.5-11.5T732-692q11 11 11 28t-11 28L577-480Z"
              />
            </svg>
          </button>
        </li>
        <li>
          <a href="firstry_home.html">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M240-200h120v-200q0-17 11.5-28.5T400-440h160q17 0 28.5 11.5T600-400v200h120v-360L480-740 240-560v360Zm-80 0v-360q0-19 8.5-36t23.5-28l240-180q21-16 48-16t48 16l240 180q15 11 23.5 28t8.5 36v360q0 33-23.5 56.5T720-120H560q-17 0-28.5-11.5T520-160v-200h-80v200q0 17-11.5 28.5T400-120H240q-33 0-56.5-23.5T160-200Zm320-270Z"
              />
            </svg>
            <span>Home</span>
          </a>
        </li>
        <li>
          <button onclick="toggleSubMenu(this)" class="dropdown-btn">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M720-400v-120H600v-80h120v-120h80v120h120v80H800v120h-80Zm-360-80q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-160v-112q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"
              />
            </svg>
            <span>Add+ Person</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"
              />
            </svg>
          </button>
          <ul class="sub-menu">
            <div>
              <li><a href="firstry_addteach.html">Add Teacher</a></li>
              <li>
                <a href="firstry_addstudent.html">Add Student</a>
              </li>
            </div>
          </ul>
        </li>

        <li>
          <button onclick="toggleSubMenu(this)" class="dropdown-btn">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M680-600h160q17 0 28.5 11.5T880-560q0 17-11.5 28.5T840-520H680q-17 0-28.5-11.5T640-560q0-17 11.5-28.5T680-600ZM360-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM40-240v-32q0-34 17.5-62.5T104-378q62-31 126-46.5T360-440q66 0 130 15.5T616-378q29 15 46.5 43.5T680-272v32q0 33-23.5 56.5T600-160H120q-33 0-56.5-23.5T40-240Zm80 0h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56 0-111 13.5T140-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T440-640q0-33-23.5-56.5T360-720q-33 0-56.5 23.5T280-640q0 33 23.5 56.5T360-560Zm0-80Zm0 400Z"
              />
            </svg>
            <span>Remove Person</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"
              />
            </svg>
          </button>
          <ul class="sub-menu">
            <div>
              <li class>
                <a href="firstry_removeteach.html">Remove Teacher</a>
              </li>
              <li><a href="firstry_.html">Remove Student</a></li>
            </div>
          </ul>
        </li>
        <li>
          <button onclick="toggleSubMenu(this)" class="dropdown-btn">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M80-320v-80h80v80H80Zm0-160v-80h80v80H80Zm0-160v-80h80v80H80Zm160 320v-80h160v80H240Zm0-160v-80h520v80H240Zm0-160v-80h520v80H240Zm398 480L468-330l57-57 113 113 226-226 56 58-282 282Z"
              />
            </svg>
            <span>Manage</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M480-361q-8 0-15-2.5t-13-8.5L268-556q-11-11-11-28t11-28q11-11 28-11t28 11l156 156 156-156q11-11 28-11t28 11q11 11 11 28t-11 28L508-372q-6 6-13 8.5t-15 2.5Z"
              />
            </svg>
          </button>
          <ul class="sub-menu">
            <div>
              <li><a href="firstry_MangRooms.html">Room</a></li>
              <li class="active"><a href="firstry_ManagExam.html">Exam</a></li>
              <li><a href="#">Conflict</a></li>
            </div>
          </ul>
        </li>
        <li>
          <a href="">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h360v80H200v560h560v-360h80v360q0 33-23.5 56.5T760-120H200Zm80-160h80v-280h-80v280Zm160 0h80v-400h-80v400Zm160 0h80v-160h-80v160Zm80-320v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80ZM480-480Z"
              />
            </svg>
            <span>Generate<br />Seating Chart </span>
          </a>
        </li>
        <li>
          <a href="">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="#e8eaed"
            >
              <path
                d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"
              />
            </svg>
            <span>Settings</span>
          </a>
        </li>
      </ul>
    </nav>

    <main>
      <h2
        style="
          color: rgb(29, 197, 127);
          text-align: center;
          margin-bottom: 18px;
        "
      >
        Exam Management
      </h2>
      <div class="containerMain">
        <form name="google-sheet">
          <!-- Course Multi-Select -->

          <label for="course">Course:</label>
          <select id="course" name="Course" required>
            <option value="">Select Course</option>
            <option value="Computer">Computer</option>
            <option value="Maths">Maths</option>
            <option value="Science">Science</option>
            <option value="English">English</option>
            <option value="History">History</option>
          </select>

          <br /><br />

          <!-- Exam Name -->
          <label for="examName">Exam Name:</label>
          <input
            type="text"
            id="examName"
            placeholder="e.g., Midterm"
            required
            class="Exam-input"
            name="Exam Name"
          />
          <br /><br />

          <!-- Exam Date -->
          <label for="examDate">Exam Date:</label>

          <input
            type="text"
            id="examDate"
            placeholder="dd/mm/yyyy"
            pattern="\d{2}/\d{2}/\d{4}"
            maxlength="10"
            required
            class="Exam-input"
            name="Exam Date"
          />

          <br /><br />

          <!-- Timeslot -->
          <fieldset style="border: 5px double rgb(44, 151, 98)">
            <legend style="color: rgb(38, 136, 105)">Timeslot</legend>
            <label for="startTime">Start Time:</label>
            <!-- Start Time -->
            <input
              type="text"
              id="startTime"
              name="Start Time"
              placeholder="hh:mm"
              pattern="[0-2][0-9]:[0-5][0-9]"
              maxlength="5"
              required
              class="Exam-input"
            />

            <select id="startMeridiem" name="startMeridiem">
              <option value="AM">AM</option>
              <option value="PM">PM</option>
            </select>
            <br />
            <label for="endTime">End Time:</label>
            <!-- End Time -->
            <input
              type="text"
              id="endTime"
              name="End Time"
              placeholder="hh:mm"
              pattern="[0-2][0-9]:[0-5][0-9]"
              maxlength="5"
              required
              class="Exam-input"
            />

            <select id="endMeridiem" name="endMeridiem">
              <option value="AM">AM</option>
              <option value="PM">PM</option>
            </select>
            <br />
          </fieldset>

          <br /><br />

          <!-- Room Multi-Select -->
          <label for="room">Room:</label>
          <select id="room" name="Room" required>
            <option value="">Select Room</option>
            <option value="Room 101">Room 101</option>
            <option value="Room 102">Room 102</option>
            <option value="Room 103">Room 103</option>
            <option value="Lab A">Lab A</option>
          </select>

          <br /><br />

          <!-- Supervising Teacher Multi-Select -->
          <label for="teacher">Supervising Teacher:</label>
          <select id="teacher" name="Teacher" required>
            <option value="">Select Supervising Teacher</option>
            <option value="Mr. Smith" name="Teacher">Mr. Smith</option>
            <option value="Ms. Johnson" name="Teacher">Ms. Johnson</option>
            <option value="Dr. Brown" name="Teacher">Dr. Brown</option>
            <option value="Prof. Lee" name="Teacher">Prof. Lee</option>
          </select>
          <br /><br />

          <!-- Submit Button -->
          <button type="submit" name="Submit">Schedule Exam</button>
        </form>
        <span class="spanforanchor"
          ><a
            target="_blank"
            class="Sheet_Link"
            href="https://docs.google.com/spreadsheets/d/163neHbjKWojM6mOoqy8QHfaU2r5mgFZRzNKta6bmsHg/edit?usp=sharing"
          >
            <div class="Check_Sheet">Check Sheet</div>
          </a>
        </span>
      </div>
    </main>
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        // Load firstry.js dynamically
        const script = document.createElement("script");
        script.src = "/rebellion/js/firstry.js";
        script.onerror = () => console.error("Failed to load firstry.js");
        document.head.appendChild(script);

        // Handle Google Sheets form submission
        const scriptURL =
          "https://script.google.com/macros/s/AKfycbxu9mWDn6jItHjo4qky5uKa8pfpyoX9fmI43DQHBNumrk3DNVz6v2hgOgbeVDxE8lNK/exec";
        const form = document.forms["google-sheet"];

        if (form) {
          form.addEventListener("submit", (e) => {
            e.preventDefault();

            // Combine time inputs with AM/PM
            const startTime = `${form["Start Time"].value} ${form.startMeridiem.value}`;
            const endTime = `${form["End Time"].value} ${form.endMeridiem.value}`;

            // Create new FormData and update time values
            const formData = new FormData(form);
            formData.set("Start Time", startTime);
            formData.set("End Time", endTime);

            // Remove the separate AM/PM fields
            formData.delete("startMeridiem");
            formData.delete("endMeridiem");

            fetch(scriptURL, {
              method: "POST",
              body: formData,
            })
              .then((response) => {
                if (response.ok) {
                  alert("Exam scheduled successfully!");
                  form.reset();
                } else {
                  throw new Error("Network response was not ok");
                }
              })
              .catch((error) => {
                console.error("Error!", error.message);
                alert("Error submitting form. Please try again.");
              });
          });
        } else {
          console.error("Form with name 'google-sheet' not found.");
        }
      });
    </script>
  </body>
</html>
